{"version":3,"file":"vplidebinaryfile.min.js","sources":["../src/vplidebinaryfile.js"],"sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Binary files extension methods. Add to VPLFile object.\n *\n * @copyright 2013 Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\nimport $ from 'jquery';\nimport {VPLUtil} from 'mod_vpl/vplutil';\n\nexport const binaryExtension = function() {\n    var type2HTML = {\n        'img': '<img />',\n        'audio': '<audio controls></audio>',\n        'video': '<video controls></video>',\n        'binary': '<div></div>'\n    };\n    this.isBinary = function() {\n        return true;\n    };\n    this.getType = function() {\n        if (VPLUtil.isImage(this.getFileName())) {\n            return 'img';\n        }\n        if (VPLUtil.isAudio(this.getFileName())) {\n            return 'audio';\n        }\n        if (VPLUtil.isVideo(this.getFileName())) {\n            return 'video';\n        }\n        return 'binary';\n    };\n    var setOldContent = this.setContent;\n    this.setContent = function(c) {\n        setOldContent.call(this, c);\n        this.setModified();\n        this.updateDataURL();\n    };\n    this.updateDataURL = function(type, fileName, value) {\n        var tid = this.getTId();\n        var prevalue = 'data:' + VPLUtil.getMIME(fileName) + ';base64,';\n        $(tid).find(type).attr('src', prevalue + value);\n    };\n    this.adjustSize = function() {\n        if (!this.isOpen()) {\n            return false;\n        }\n        var editTag = $(this.getTId());\n        if (editTag.length === 0) {\n            return false;\n        }\n        var tabs = editTag.parent();\n        var newHeight = tabs.height();\n        newHeight -= editTag.position().top;\n        if (newHeight != editTag.height()) {\n            editTag.height(newHeight);\n            return true;\n        }\n        return false;\n    };\n    this.open = function() {\n        this.showFileName();\n        var tid = this.getTId();\n        this.setOpen(true);\n        var type = this.getType();\n        $(tid).addClass('vpl_ide_' + type).append(type2HTML[type]);\n        if (type === 'binary') {\n            $(tid).find(type).text(VPLUtil.str('binaryfile') + \": '\" + this.getFileName() + \"'\");\n        } else {\n            this.updateDataURL(type, this.getFileName(), this.getContent());\n        }\n    };\n    this.close = function() {\n        this.setOpen(false);\n    };\n    this.langSelection = function() {\n        this.setLang('Binary');\n    };\n};\n"],"names":["type2HTML","isBinary","getType","VPLUtil","isImage","this","getFileName","isAudio","isVideo","setOldContent","setContent","c","call","setModified","updateDataURL","type","fileName","value","tid","getTId","prevalue","getMIME","find","attr","adjustSize","isOpen","editTag","length","newHeight","parent","height","position","top","open","showFileName","setOpen","addClass","append","text","str","getContent","close","langSelection","setLang"],"mappings":";;;;;;;8KA0B+B,eACvBA,UAAY,KACL,gBACE,iCACA,kCACC,oBAETC,SAAW,kBACL,QAENC,QAAU,kBACPC,iBAAQC,QAAQC,KAAKC,eACd,MAEPH,iBAAQI,QAAQF,KAAKC,eACd,QAEPH,iBAAQK,QAAQH,KAAKC,eACd,QAEJ,cAEPG,cAAgBJ,KAAKK,gBACpBA,WAAa,SAASC,GACvBF,cAAcG,KAAKP,KAAMM,QACpBE,mBACAC,sBAEJA,cAAgB,SAASC,KAAMC,SAAUC,WACtCC,IAAMb,KAAKc,SACXC,SAAW,QAAUjB,iBAAQkB,QAAQL,UAAY,+BACnDE,KAAKI,KAAKP,MAAMQ,KAAK,MAAOH,SAAWH,aAExCO,WAAa,eACTnB,KAAKoB,gBACC,MAEPC,SAAU,mBAAErB,KAAKc,aACE,IAAnBO,QAAQC,cACD,MAGPC,UADOF,QAAQG,SACEC,gBACrBF,WAAaF,QAAQK,WAAWC,MACfN,QAAQI,WACrBJ,QAAQI,OAAOF,YACR,SAIVK,KAAO,gBACHC,mBACDhB,IAAMb,KAAKc,cACVgB,SAAQ,OACTpB,KAAOV,KAAKH,8BACdgB,KAAKkB,SAAS,WAAarB,MAAMsB,OAAOrC,UAAUe,OACvC,WAATA,yBACEG,KAAKI,KAAKP,MAAMuB,KAAKnC,iBAAQoC,IAAI,cAAgB,MAAQlC,KAAKC,cAAgB,UAE3EQ,cAAcC,KAAMV,KAAKC,cAAeD,KAAKmC,oBAGrDC,MAAQ,gBACJN,SAAQ,SAEZO,cAAgB,gBACZC,QAAQ"}