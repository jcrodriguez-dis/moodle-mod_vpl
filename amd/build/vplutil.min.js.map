{"version":3,"sources":["../src/vplutil.js"],"names":["define","$","jqui","log","VPLUtil","doNothing","noop","returnFalse","returnTrue","debugMode","m","forced","debug","setUserPreferences","pref","ajax","async","type","url","JSON","stringify","contentType","dataType","getUserPreferences","func","getPreferences","done","scrollBarWidth","parent","child","width","appendTo","children","innerWidth","height","remove","sanitizeHTML","t","replace","html","sanitizeText","s","setProtocol","coninfo","secure","securePort","port","wsProtocol","window","location","protocol","URLBase","server","portToUse","monitorURL","monitorPath","executionURL","executionPath","ArrayBuffer2String","data","view","Uint8Array","chunks","chunkSize","i","len","length","push","String","fromCharCode","apply","subarray","Math","min","join","String2ArrayBuffer","ret","ArrayBuffer","u8","charCodeAt","fileUniqueId","getUniqueId","fileExtension","fileName","res","exec","isImage","test","isBinary","isBlockly","validFileName","getCurrentTime","parseInt","Date","valueOf","encodeBinary","name","btoa","unescape","encodeURIComponent","decodeBinary","decoded","atob","decodeURIComponent","escape","validPath","path","dirs","split","getFileName","dataFromURLData","substr","indexOf","readZipFile","save","progressBar","end","JUnzip","loadScript","ab","unzipper","isZipFile","readEntries","out","entries","process","isClosed","entry","match","processFile","uncompressed","compressionMethod","JSInflate","inflate","contents","encoding","blob","Blob","fr","FileReader","onload","e","target","result","onerror","readAsText","readSelectedFiles","filesToRead","pb","errorsMessages","setLabel","readSecuencial","sec","close","showErrorMessage","f","binary","reader","ext","toLowerCase","ex","error","readAsArrayBuffer","readAsDataURL","MIME","getMIME","getTimeLeft","timeLeft","minute","hour","day","timePending","days","hours","minutes","seconds","maplang","langType","i18n","str","key","parm","setStr","newi18n","hasOwnProperty","dialogbaseOptions","minWidth","autoOpen","closeText","modal","dialogClass","VPLi18n","delayedActions","afterAllActions","longTimeout","numberDelayed","delay","id","arg1","arg2","clearTimeout","setTimeout","longDelay","setAfterTimeout","afterAll","iconModified","iconDelete","iconClose","iconRequired","iconFolder","menuIcons","genIcon","icon","size","classes","icons","setTitleBar","dialog","buttons","handler","title","find","genButton","titleButtons","titleText","ih","button","click","css","on","blur","setDialogTitleIcon","message","onUserClose","sppiner","append","progressbar","label","resizable","minHeight","event","originalEvent","text","titleTag","siblings","showMessage","initialoptions","options","extend","messageDialog","messageButtons","ok","yes","next","setMessage","men","currentOptions","requestAction","action","URL","deferred","Deferred","request","xhr","apb","readyState","abort","beforeSend","jqXHR","always","response","success","reject","resolve","fail","textStatus","errorThrown","responseText","supportWebSocket","isAndroid","navigator","userAgent","isFirefox","isMac","clickServer","h","left","screen","top","features","win","open","attr","preventDefault","hide","acceptCertificates","servers","getLastAction","n","monitorRunning","webSocketMonitor","running","externalActions","ws","defail","delegated","messageActions","content","parsed","state","detail","getConsole","isOpen","setResult","ajaxurl","run","WebSocket","notOpen","onopen","onclose","disconnect","onmessage","CLOSED","processResult","filenames","sh","noFormat","folding","escReg","regcas","regError","RegExp","regWarning","comment","case_","lines","regFiles","lastAnotation","lastAnotationFile","afterTitle","getHref","getTagId","regf","genFileLinks","line","rawline","used","reg","anot","getAnnotations","search","href","lt","setAnnotations","getTitle","getComment","addComment","addCase","getCase","regcasv","scriptsLoaded","scripts","scriptURL","shift","script","document","createElement","src","scriptPath","head","appendChild","isScriptLoading","isScriptLoaded","adjustBlockly","work","offx","offy","blocks","getAllBlocks","miy","may","mix","max","xy","getRelativeToSurfaceXY","y","x","getTopBlocks","j","moveBy","files","results","shs","SubmissionHighlighter","self","highlight","prototype","highlightBlockly","preid","tag","c","show","xml","Blockly","Xml","textToDom","inject","toolbox","readOnly","media","domToWorkspace","hg","svgResize","resizeSvgContents","dispose","needAce","file","ace","shFiles","shFileNames","tagId","lang","edit","setTheme","theme","getSession","setMode","renderer","setShowGutter","showln","setReadOnly","setHighlightActiveLine","setAutoScrollEditorIntoView","setOption","nl","a","vplTagId","ri","getElementById","textContent","innerText","innerHTML","addResults","syntaxHighlightFile","syntaxHighlight","flEventHandler","getAttribute","substring","gotoLine","scrollToLine","setflEventHandler","links","getElementsByClassName","onclick","showHideDiv","div","nextSibling","parentNode","nodeName","savedDisplay","style","display","VPLDebugMode","init"],"mappings":"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","sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tools for IDE and related\n * @package mod_vpl\n * @copyright 2016 Juan Carlos Rodrguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodrguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\n/* globals JUnzip */\n/* globals JSInflate */\n/* globals Blockly */\n/* globals ace */\n\n\ndefine(\n    [\n        'jquery',\n        'jqueryui',\n        'core/log',\n    ],\n    function($, jqui, log) {\n        var VPLUtil = {};\n        VPLUtil.doNothing = $.noop;\n        VPLUtil.returnFalse = function() {\n            return false;\n        };\n        VPLUtil.returnTrue = function() {\n            return true;\n        };\n        var debugMode = false;\n        VPLUtil.log = function(m, forced) {\n            if (debugMode || forced) {\n                log.debug(m);\n            }\n        };\n        VPLUtil.setUserPreferences = function(pref) {\n            $.ajax({\n                async: true,\n                type: \"POST\",\n                url: '../editor/userpreferences.json.php',\n                'data': JSON.stringify(pref),\n                contentType: \"application/json; charset=utf-8\",\n                dataType: \"json\"\n            });\n        };\n        VPLUtil.getUserPreferences = function(func) {\n            $.ajax({\n                async: true,\n                type: \"POST\",\n                url: '../editor/userpreferences.json.php',\n                'data': JSON.stringify({getPreferences: true}),\n                contentType: \"application/json; charset=utf-8\",\n                dataType: \"json\"\n            }).done(func);\n        };\n        // Get scrollBarWidth.\n        VPLUtil.scrollBarWidth = function() {\n            var parent, child, width;\n            parent = $('<div style=\"width:50px;height:50px;overflow:auto\"><div/></div>').appendTo('body');\n            child = parent.children();\n            width = child.innerWidth() - child.height(99).innerWidth();\n            parent.remove();\n            return width;\n        };\n        VPLUtil.sanitizeHTML = function(t) {\n            if (typeof t == 'undefined' || t.replace(/^\\s+$/g, '') == '') {\n                return '';\n            }\n            return $('<div>' + t + '</div>').html();\n        };\n        VPLUtil.sanitizeText = function(s) {\n            if (typeof s == 'undefined' || s.replace(/^\\s+$/g, '') == '') {\n                return '';\n            }\n            return s.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n        };\n\n        VPLUtil.setProtocol = function(coninfo) {\n            var secure;\n            if (coninfo.securePort == 0 || coninfo.port == 0) {\n                secure = coninfo.port == 0;\n            } else {\n                switch (coninfo.wsProtocol) {\n                    case 'always_use_wss':\n                        secure = true;\n                        break;\n                    case 'always_use_ws':\n                        secure = false;\n                        break;\n                    default:\n                        secure = window.location.protocol == 'https:';\n                }\n            }\n            var URLBase = (secure ? 'wss://' : 'ws://') + coninfo.server;\n            coninfo.secure = secure;\n            coninfo.portToUse = secure ? coninfo.securePort : coninfo.port;\n            URLBase += ':' + coninfo.portToUse + '/';\n            coninfo.monitorURL = URLBase + coninfo.monitorPath;\n            coninfo.executionURL = URLBase + coninfo.executionPath;\n        };\n        VPLUtil.ArrayBuffer2String = function(data) {\n            var view = new Uint8Array(data);\n            var chunks = [];\n            var chunkSize = 32000;\n            var i, len;\n            for (i = 0, len = view.length; i < len; i += chunkSize) {\n                chunks.push(String.fromCharCode.apply(String, view.subarray(i, Math.min(i + chunkSize, len))));\n            }\n            return chunks.join('');\n        };\n        VPLUtil.String2ArrayBuffer = function(data) {\n            var len = data.length;\n            var ret = new ArrayBuffer(len);\n            var u8 = new Uint8Array(ret);\n            for (var i = 0; i < len; i++) {\n                u8[i] = data.charCodeAt(i);\n            }\n            return ret;\n        };\n\n        (function() {\n            var fileUniqueId = 0;\n            VPLUtil.getUniqueId = function() {\n                return fileUniqueId++;\n            };\n        })();\n        (function() {\n            var regExt = /\\.([^.]*)$/;\n            var regImg = /^(gif|jpg|jpeg|png|ico)$/i;\n            var regBin = /^(zip|jar|pdf|tar|bin|7z|arj|deb|gzip|rar|rpm|dat|db|dll|rtf|doc|docx|odt|exe|com)$/i;\n            var regBlk = /^blockly[0123]?$/;\n            VPLUtil.fileExtension = function(fileName) {\n                var res = regExt.exec(fileName);\n                return res !== null ? res[1] : '';\n            };\n            VPLUtil.isImage = function(fileName) {\n                return regImg.test(VPLUtil.fileExtension(fileName));\n            };\n            VPLUtil.isBinary = function(fileName) {\n                return VPLUtil.isImage(fileName) || regBin.test(VPLUtil.fileExtension(fileName));\n            };\n            VPLUtil.isBlockly = function(fileName) {\n                return regBlk.test(VPLUtil.fileExtension(fileName));\n            };\n            var regInvalidFileName = /[\\cA-\\cZ]|[:-@]|[{-~]|\\\\|\\[|\\]|[/^`]|^-|^ | $|\\.\\./;\n            VPLUtil.validFileName = function(fileName) {\n                if (fileName.length < 1) {\n                    return false;\n                }\n                if (fileName.length > 128) {\n                    return false;\n                }\n                return !(regInvalidFileName.test(fileName));\n            };\n        })();\n        VPLUtil.getCurrentTime = function() {\n            return parseInt((new Date()).valueOf() / 1000);\n        };\n        VPLUtil.encodeBinary = function(name, data) {\n            if (!VPLUtil.isBinary(name)) {\n                return btoa(unescape(encodeURIComponent(data)));\n            }\n            return btoa(VPLUtil.ArrayBuffer2String(data));\n        };\n\n        VPLUtil.decodeBinary = function(name, data) {\n            var decoded = atob(data);\n            if (!VPLUtil.isBinary(name)) {\n                return decodeURIComponent(escape(decoded));\n            }\n            return VPLUtil.String2ArrayBuffer(decoded);\n        };\n\n        VPLUtil.validPath = function(path) {\n            if (path.length > 256) {\n                return false;\n            }\n            var dirs = path.split(\"/\");\n            for (var i = 0; i < dirs.length; i++) {\n                if (!VPLUtil.validFileName(dirs[i])) {\n                    return false;\n                }\n            }\n            return true;\n        };\n        VPLUtil.getFileName = function(path) {\n            var dirs = path.split(\"/\");\n            return dirs[dirs.length - 1];\n        };\n        VPLUtil.dataFromURLData = function(data) {\n            return data.substr(data.indexOf(',') + 1);\n        };\n        VPLUtil.readZipFile = function(data, save, progressBar, end) {\n            if (!end) {\n                end = VPLUtil.doNothing;\n            }\n            if (typeof JUnzip == 'undefined') {\n                VPLUtil.loadScript(['../editor/zip/inflate.js',\n                    '../editor/zip/unzip.js']\n                , function() {\n                    VPLUtil.readZipFile(data, save, progressBar, end);\n                });\n                return;\n            }\n            var ab = VPLUtil.ArrayBuffer2String(data);\n            var unzipper = new JUnzip(ab);\n            if (!unzipper.isZipFile()) {\n                VPLUtil.log('Not a ZIP file');\n                end();\n                return;\n            }\n            unzipper.readEntries();\n            var out = unzipper.entries.length;\n            /**\n            * Process each entry in the zip file.\n            * Recursive process.\n            * @param {int} i Entry to process.\n            */\n            function process(i) {\n                if (i >= out || progressBar.isClosed()) {\n                    end();\n                    return;\n                }\n                var entry = unzipper.entries[i];\n                var fileName = entry.fileName;\n                var data;\n                // Is directory entry then skip.\n                if (fileName.match(/\\/$/)) {\n                    process(i + 1);\n                } else {\n                    progressBar.processFile(fileName);\n                    var uncompressed = '';\n                    if (entry.compressionMethod === 0) {\n                        // Plain file.\n                        uncompressed = entry.data;\n                    } else if (entry.compressionMethod === 8) {\n                        uncompressed = JSInflate.inflate(entry.data);\n                    }\n                    if (VPLUtil.isBinary(fileName)) {\n                        // If binary use as arrayBuffer.\n                        save({name: fileName, contents: btoa(uncompressed), encoding: 1});\n                        // TODO Show message when error.\n                        process(i + 1);\n                    } else {\n                        data = VPLUtil.String2ArrayBuffer(uncompressed);\n                        var blob = new Blob([data], {\n                            type: 'text/plain'\n                        });\n                        var fr = new FileReader();\n                        fr.onload = function(e) {\n                            save({name: fileName, contents: e.target.result, encoding: 0});\n                            process(i + 1);\n                        };\n                        fr.onerror = function(e) {\n                            VPLUtil.log(e);\n                            i = out;\n                            process(i + 1);\n                            // TODO Show message when error.\n                        };\n                        fr.readAsText(blob);\n                    }\n                }\n            }\n            process(0);\n        };\n\n        VPLUtil.readSelectedFiles = function(filesToRead, save, end) {\n            // Process all File objects.\n            var pb = new VPLUtil.progressBar('import', 'import');\n            var errorsMessages = '';\n            if (!end) {\n                end = VPLUtil.doNothing;\n            }\n            pb.processFile = function(name) {\n                pb.setLabel(name);\n            };\n            /**\n            * Read each file in filesToReas\n            * Recursive process.\n            * @param {int} sec secuencial file to read\n            */\n            function readSecuencial(sec) {\n                if (sec >= filesToRead.length || pb.isClosed()) {\n                    end();\n                    pb.close();\n                    if (errorsMessages > '') {\n                        VPLUtil.showErrorMessage(errorsMessages);\n                    }\n                    return;\n                }\n                var f = filesToRead[sec];\n                pb.processFile(f.name);\n                var binary = VPLUtil.isBinary(f.name);\n                var reader = new FileReader();\n                var ext = VPLUtil.fileExtension(f.name).toLowerCase();\n                reader.onload = function(e) {\n                    if (binary) {\n                        if (ext == 'zip') {\n                            try {\n                                VPLUtil.readZipFile(e.target.result, save, pb, function() {\n                                                                                  readSecuencial(sec + 1);\n                                                                               });\n                                return;\n                            } catch (ex) {\n                                VPLUtil.showErrorMessage(ex + \" : \" + f.name);\n                            }\n                        } else {\n                            var data = VPLUtil.dataFromURLData(e.target.result);\n                            save({name: f.name, contents: data, encoding: 1});\n                        }\n                    } else {\n                        save({name: f.name, contents: e.target.result, encoding: 0});\n                    }\n                    readSecuencial(sec + 1);\n                };\n                reader.onerror = function(e) {\n                    errorsMessages += \"Error \\\"\" + e.target.error + \"\\\" reading \" + f.name + \"\\n\";\n                    readSecuencial(sec + 1);\n                };\n                if (binary) {\n                    if (ext == 'zip') {\n                        reader.readAsArrayBuffer(f);\n                    } else {\n                        reader.readAsDataURL(f);\n                    }\n                } else {\n                    reader.readAsText(f);\n                }\n            }\n            readSecuencial(0);\n        };\n        (function() {\n            var MIME = {\n                'gif': 'image/gif',\n                'jpg': 'image/jpeg',\n                'jpeg': 'image/jpeg',\n                'png': 'image/png',\n                'ico': 'image/vnd.microsoft.icon',\n                'pdf': 'application/pdf'\n            };\n            VPLUtil.getMIME = function(fileName) {\n                var ext = VPLUtil.fileExtension(fileName);\n                if (ext in MIME) {\n                    return MIME[ext];\n                }\n                return 'application/octet-stream';\n            };\n            VPLUtil.getTimeLeft = function(timeLeft) {\n                var res = '';\n                var minute = 60;\n                var hour = 60 * minute;\n                var day = 24 * hour;\n                if (timeLeft < 0) {\n                    res += '-';\n                    timeLeft = -timeLeft;\n                }\n                var timePending = timeLeft;\n                var days = parseInt(timePending / day);\n                timePending -= days * day;\n                if (days !== 0) {\n                    res += days + 'T';\n                }\n                var hours = parseInt(timePending / hour);\n                timePending -= hours * hour;\n                var minutes = parseInt(timePending / minute);\n                timePending -= minutes * minute;\n                var seconds = parseInt(timePending);\n                res += ('00' + hours).substr(-2) + ':';\n                res += ('00' + minutes).substr(-2);\n                if (timeLeft < hour) {\n                    res += ':' + ('00' + seconds).substr(-2);\n                }\n                return res;\n            };\n        })();\n        (function() {\n            var maplang = {\n                'abap': 'abap',\n                'abc': 'abc',\n                'ada': 'ada', 'ads': 'ada', 'adb': 'ada',\n                'as': 'actionscript', 'as3': 'actionscript',\n                'asm': 'assembly_x86',\n                'bash': 'sh',\n                'bat': 'batchfile',\n                'c': 'c_cpp', 'C': 'c_cpp', 'cc': 'c_cpp', 'cpp': 'c_cpp', 'c++': 'c_cpp',\n                'hxx': 'c_cpp', 'h': 'c_cpp', 'H': 'c_cpp',\n                'cases': 'cases',\n                'cbl': 'cobol', 'cob': 'cobol',\n                'coffee': 'coffee',\n                'clj': 'clojure',\n                'cs': 'csharp',\n                'css': 'css',\n                'd': 'd',\n                'dart': 'dart',\n                'e': 'eiffel',\n                'erl': 'erlang', 'hrl': 'erlang',\n                'f': 'fortran', 'f77': 'fortran', 'f90': 'fortran', 'for': 'fortran',\n                'go': 'golang',\n                'groovy': 'groovy',\n                'gv': 'dot',\n                'hs': 'haskell',\n                'htm': 'html', 'html': 'html',\n                'hx': 'haxe',\n                'java': 'java',\n                'js': 'javascript',\n                'json': 'json',\n                'jsp': 'jsp',\n                'jsx': 'jsx',\n                'kt': 'kotlin', 'kts': 'kotlin',\n                'm': 'matlab',\n                'md': 'markdown',\n                'less': 'less',\n                'lisp': 'lisp', 'lsp': 'lisp',\n                'lua': 'lua',\n                'pas': 'pascal', 'p': 'pascal',\n                'perl': 'perl', 'prl': 'perl',\n                'php': 'php',\n                'pro': 'prolog', 'pl': 'prolog',\n                'py': 'python',\n                'R': 'r', 'r': 'r',\n                'rb': 'ruby', 'ruby': 'ruby',\n                's': 'assembly_x86',\n                'sass': 'sass',\n                'scala': 'scala',\n                'scm': 'scheme',\n                'scss': 'scss',\n                'sh': 'sh',\n                'swift': 'swift',\n                'sql': 'sql',\n                'svg': 'svg',\n                'tex': 'tex',\n                'tcl': 'tcl',\n                'ts': 'typescript',\n                'twig': 'twig',\n                'vbs': 'vbscript',\n                'v': 'verilog', 'vh': 'verilog',\n                'vhd': 'vhdl', 'vhdl': 'vhdl',\n                'xml': 'xml',\n                'yaml': 'yaml'\n            };\n            VPLUtil.langType = function(ext) {\n                if (ext in maplang) {\n                    return maplang[ext];\n                }\n                return 'plain_text';\n            };\n        })();\n        (function() {\n            var i18n = {};\n            var strreg = /\\{\\\\*\\$a\\\\*}/g;\n            VPLUtil.str = function(key, parm) {\n                if (!i18n[key]) {\n                    return '{' + key + '}';\n                }\n                if (typeof parm != 'undefined') {\n                    return i18n[key].replace(strreg, parm);\n                } else {\n                    return i18n[key];\n                }\n            };\n            VPLUtil.setStr = function(newi18n) {\n                for (var key in newi18n) {\n                    if (newi18n.hasOwnProperty(key)) {\n                        i18n[key] = newi18n[key];\n                    }\n                }\n                VPLUtil.dialogbaseOptions = {\n                    minWidth: 200,\n                    autoOpen: false,\n                    width: 'auto',\n                    closeText: VPLUtil.str('cancel'),\n                    modal: true,\n                    dialogClass: 'vpl_ide vpl_ide_dialog'\n                };\n            };\n            VPLUtil.setStr(window.VPLi18n);\n        })();\n        (function() {\n            var delayedActions = {};\n            var afterAllActions = {};\n            var shortTimeout = 20;\n            var longTimeout = 100;\n            var numberDelayed = 0;\n            VPLUtil.delay = function(id, func, arg1, arg2) {\n                if (typeof delayedActions[id] != 'undefined') {\n                    clearTimeout(delayedActions[id]);\n                    numberDelayed--;\n                }\n                numberDelayed++;\n                delayedActions[id] = setTimeout(function() {\n                    numberDelayed--;\n                    func(arg1, arg2);\n                    delete delayedActions[id];\n                }, shortTimeout);\n            };\n            VPLUtil.longDelay = function(id, func, arg1, arg2) {\n                if (typeof delayedActions[id] != 'undefined') {\n                    clearTimeout(delayedActions[id]);\n                    numberDelayed--;\n                }\n                numberDelayed++;\n                delayedActions[id] = setTimeout(function() {\n                    numberDelayed--;\n                    func(arg1, arg2);\n                    delete delayedActions[id];\n                }, longTimeout);\n            };\n            var setAfterTimeout = function(id, func, arg1, arg2) {\n                if (typeof afterAllActions[id] != 'undefined') {\n                    clearTimeout(afterAllActions[id]);\n                }\n                return setTimeout(function() {\n                        if (numberDelayed > 0) {\n                            afterAllActions[id] = setAfterTimeout(id, func, arg1, arg2);\n                        } else {\n                             func(arg1, arg2);\n                             delete afterAllActions[id];\n                        }\n                    }, longTimeout);\n            };\n            VPLUtil.afterAll = function(id, func, arg1, arg2) {\n                afterAllActions[id] = setAfterTimeout(id, func, arg1, arg2);\n            };\n        })();\n        VPLUtil.iconModified = function() {\n            var html = '<span title=\"' + VPLUtil.str('modified') + '\" class=\"vpl_ide_charicon\">';\n            html += '<i class=\"fa fa-star\"></i>' + '</span> ';\n            return html;\n        };\n        VPLUtil.iconDelete = function() {\n            var html = ' <span title=\"' + VPLUtil.str('delete') + '\" class=\"vpl_ide_charicon vpl_ide_delicon\">';\n            html += '<i class=\"fa fa-trash\"></i>' + '</span> ';\n            return html;\n        };\n        VPLUtil.iconClose = function() {\n            var html = ' <span title=\"' + VPLUtil.str('closebuttontitle');\n            html += '\" class=\"vpl_ide_charicon vpl_ide_closeicon\">' + '<i class=\"fa fa-remove\"></i>' + '</span> ';\n            return html;\n        };\n        VPLUtil.iconRequired = function() {\n            var html = ' <span title=\"' + VPLUtil.str('required') + '\" class=\"vpl_ide_charicon\">';\n            html += '<i class=\"fa fa-shield\"></i>' + '</span> ';\n            return html;\n        };\n        VPLUtil.iconFolder = function() {\n            return '<i class=\"fa fa-folder-open-o\"></i>';\n        };\n        (function() {\n            var menuIcons = {\n                'filelist': 'folder-o',\n                'filelistclose': 'folder-open-o',\n                'new': 'file-code-o',\n                'rename': 'pencil',\n                'delete': 'trash',\n                'multidelete': 'trash|list',\n                'close': 'remove',\n                'comments': 'commenting',\n                'import': 'upload',\n                'print': 'print',\n                'edit': 'edit',\n                'undo': 'undo',\n                'redo': 'repeat',\n                'select_all': 'location-arrow',\n                'find': 'search',\n                'find_replace': 'exchange',\n                'next': 'search-plus',\n                'resetfiles': 'refresh',\n                'download': 'download',\n                'fullscreen': 'expand',\n                'regularscreen': 'compress',\n                'save': 'save',\n                'shortcuts': 'flash',\n                'sort': 'list-ol',\n                'run': 'rocket',\n                'running': 'rocket fa-spin',\n                'debug': 'bug',\n                'evaluate': 'check-square-o',\n                'console': 'terminal',\n                'about': 'question',\n                'info': 'info-circle',\n                'alert': 'warning',\n                'trash': 'trash',\n                'retrieve': 'download',\n                'spinner': 'refresh fa-spin',\n                'keyboard': 'keyboard-o',\n                'clipboard': 'clipboard',\n                'timeleft': 'clock-o',\n                'copy': 'copy',\n                'paste': 'paste',\n                'more': 'plus-square',\n                'less': 'minus-square',\n                'resize': 'arrows-alt',\n                'graphic': 'picture-o',\n                'send': 'send',\n                'theme':  'paint-brush',\n                'user': 'user',\n                'fontsize': 'text-height'\n            };\n            VPLUtil.genIcon = function(icon, size) {\n                if (!menuIcons[icon]) {\n                    return '';\n                }\n                var classes = 'fa fa-';\n                if (!size) {\n                    classes += 'lg';\n                } else {\n                    classes += size;\n                }\n                var icons = menuIcons[icon].split('|');\n                var ret = '';\n                for (var i = 0; i < icons.length; i++) {\n                    ret += \"<i class='\" + classes + ' fa-' + icons[i] + \"'></i>\";\n                }\n                return ret;\n            };\n        })();\n        // UI operations.\n        VPLUtil.setTitleBar = function(dialog, type, icon, buttons, handler) {\n            var title = $(dialog).parent().find(\"span.ui-dialog-title\");\n            /**\n            * Generate HTML for a button with icon\n            * @param {string} e name of botton.\n            * @returns {string} Html tag <a> as a button.\n            */\n            function genButton(e) {\n                var html = \"<a id='vpl_\" + type + \"_\" + e + \"' href='#' title='\" + VPLUtil.str(e) + \"'>\";\n                html += VPLUtil.genIcon(e, 'fw') + \"</a>\";\n                return html;\n            }\n            var html = VPLUtil.genIcon(icon);\n            html += \" <span class='\" + type + \"-title-buttons'></span>\";\n            html += \"<span class='\" + type + \"-title-text'></span>\";\n            title.html(html);\n            var titleButtons = title.find(\"span.\" + type + \"-title-buttons\");\n            var titleText = title.find(\"span.\" + type + \"-title-text\");\n            html = \"\";\n            for (var i = 0; i < buttons.length; i++) {\n                html += genButton(buttons[i]);\n            }\n            titleButtons.html(html);\n            for (var ih = 0; ih < handler.length; ih++) {\n                var button = title.find('#vpl_' + type + '_' + buttons[ih]);\n                button.button().click(handler[ih]);\n                button.css('padding', '1px 3px');\n            }\n            titleButtons.on('focus', '*', function() {\n                                              $(this).blur();\n                                          });\n            return titleText;\n        };\n        VPLUtil.setDialogTitleIcon = function(dialog, icon) {\n            var title = $(dialog).parent().find(\"span.ui-dialog-title\");\n            title.html(VPLUtil.genIcon(icon) + ' ' + title.html());\n        };\n        VPLUtil.progressBar = function(title, message, onUserClose) {\n            var labelHTML = '<span class=\"vpl_ide_progressbarlabel\"></span>';\n            var sppiner = '<div class=\"vpl_ide_progressbaricon\">' + VPLUtil.genIcon('spinner') + '</div>';\n            var pbHTML = ' <div class=\"vpl_ide_progressbar\">' + sppiner + labelHTML + '</div>';\n            var HTML = '<div class=\"vpl_ide_dialog\" style=\"display:none;\">' + pbHTML + '</div>';\n            var dialog = $(HTML);\n            $('body').append(dialog);\n            var progressbar = dialog.find('.vpl_ide_progressbar');\n            var label = progressbar.find('.vpl_ide_progressbarlabel');\n            dialog.dialog({\n                'title': VPLUtil.str(title),\n                resizable: false,\n                autoOpen: false,\n                width: 200,\n                height: 20,\n                minHeight: 20,\n                modal: true,\n                dialogClass: 'vpl_ide vpl_ide_dialog',\n                close: function(event) {\n                    if (dialog) {\n                        if (onUserClose && event.originalEvent) {\n                            onUserClose();\n                        }\n                        onUserClose = false;\n                    }\n                }\n            });\n            this.setLabel = function(t, icon) {\n                if (dialog) {\n                    label.text(t);\n                    if (icon) {\n                        label.html(VPLUtil.genIcon(icon) + ' ' + label.html());\n                    }\n                }\n            };\n            this.close = function() {\n                if (dialog) {\n                    dialog.dialog('destroy');\n                    $(dialog).remove();\n                    dialog = false;\n                }\n            };\n            this.isClosed = function() {\n                return dialog === false;\n            };\n            var titleTag = dialog.siblings().find('.ui-dialog-title');\n            titleTag.html(VPLUtil.genIcon(title) + ' ' + titleTag.html());\n            this.setLabel(VPLUtil.str(message));\n            dialog.dialog('open');\n            dialog.dialog('option', 'height', 'auto');\n        };\n        /**\n         * Shows a dialog with a message.\n         * @param {string} message\n         * @param {Object} initialoptions icon, title, actions handler (ok, yes, no, close)\n         * @returns {JQuery} JQueryUI Dialog object already open\n         */\n        VPLUtil.showMessage = function(message, initialoptions) {\n            var options = $.extend({}, VPLUtil.dialogbaseOptions, initialoptions);\n            var messageDialog = $('<div class=\"vpl_ide_dialog\" style=\"display:none\"></div>');\n            var icon = '';\n            var contents = ' <span class=\"dmessage\">' + message.replace(/\\n/g, '<br>') + '</span>';\n            messageDialog.html(contents);\n            if (typeof options.icon == 'undefined') {\n                icon = 'info';\n            } else {\n                icon = options.icon;\n                delete options.icon;\n            }\n            if (!options.title) {\n                options.title = VPLUtil.str('warning');\n            }\n            $('body').append(messageDialog);\n            var messageButtons = {};\n            if (typeof initialoptions.ok == 'function') {\n                messageButtons[VPLUtil.str('ok')] = function() {\n                    $(this).dialog('close');\n                    initialoptions.ok();\n                };\n                messageButtons[VPLUtil.str('cancel')] = function() {\n                    $(this).dialog('close');\n                };\n                delete options.ok;\n            } else if (typeof initialoptions.yes == 'function') {\n                messageButtons[VPLUtil.str('yes')] = function() {\n                    $(this).dialog('close');\n                    initialoptions.yes();\n                };\n                messageButtons[VPLUtil.str('no')] = function() {\n                    $(this).dialog('close');\n                };\n                delete options.yes;\n            } else {\n                messageButtons[VPLUtil.str('close')] = function() {\n                    $(this).dialog('close');\n                };\n            }\n            if (options.next) {\n                messageButtons[VPLUtil.str('next')] = function() {\n                    $(this).dialog('close');\n                    initialoptions.next();\n                };\n            }\n            options.close = function() {\n                    $(this).remove();\n                    if (initialoptions.close) {\n                        initialoptions.close();\n                    }\n            };\n            options.buttons = messageButtons;\n\n            messageDialog.dialog(options);\n            var titleTag = messageDialog.siblings().find('.ui-dialog-title');\n            titleTag.html(VPLUtil.genIcon(icon) + ' ' + titleTag.html());\n\n            messageDialog.setMessage = function(men) {\n                $(messageDialog).find('.dmessage').html(men.replace(/\\n/g, '<br>'));\n            };\n\n            messageDialog.dialog('open');\n            return messageDialog;\n        };\n        VPLUtil.showErrorMessage = function(message, options) {\n            var currentOptions = $.extend({}, VPLUtil.dialogbaseOptions, {\n                title: VPLUtil.str('error'),\n                icon: 'alert'\n            });\n            if (options) {\n                currentOptions = $.extend(currentOptions, options);\n            }\n            return VPLUtil.showMessage(message, currentOptions);\n        };\n\n        VPLUtil.requestAction = function(action, title, data, URL) {\n            var deferred = $.Deferred();\n            var request = null;\n            var xhr = false;\n            if (title === '') {\n                title = 'connecting';\n            }\n            var apb = new VPLUtil.progressBar(action, title, function() {\n                if (request.readyState != 4) {\n                    if (xhr && xhr.abort) {\n                        xhr.abort();\n                    }\n                }\n            });\n            request = $.ajax({\n                beforeSend: function(jqXHR) {\n                    xhr = jqXHR;\n                    return true;\n                },\n                async: true,\n                type: \"POST\",\n                url: URL + action,\n                'data': JSON.stringify(data),\n                contentType: \"application/json; charset=utf-8\",\n                dataType: \"json\"\n            }).always(function() {\n                apb.close();\n            }).done(function(response) {\n                if (!response.success) {\n                    deferred.reject(response.error);\n                } else {\n                    deferred.resolve(response.response);\n                }\n            }).fail(function(jqXHR, textStatus, errorThrown) {\n                var message = VPLUtil.str('connection_fail') + ': ' + textStatus;\n                if (debugMode) {\n                    message += '<br>' + errorThrown.message;\n                    message += '<br>' + jqXHR.responseText.substr(0, 80);\n                }\n                VPLUtil.log(message);\n                deferred.reject(message);\n            });\n            return deferred;\n        };\n        VPLUtil.supportWebSocket = function() {\n            if (\"WebSocket\" in window) {\n                return true;\n            }\n            return false;\n        };\n        VPLUtil.isAndroid = function() {\n            return window.navigator.userAgent.indexOf('Android') > -1;\n        };\n        VPLUtil.isFirefox = function() {\n            return window.navigator.userAgent.indexOf('Firefox') > -1;\n        };\n        VPLUtil.isMac = function() {\n            return window.navigator.userAgent.indexOf('Mac') > -1;\n        };\n        VPLUtil.clickServer = function(e) {\n            var w = 550;\n            var h = 450;\n            var left = (screen.width / 2) - (w / 2);\n            var top = (screen.height / 2) - (h / 2);\n            try {\n                var features = 'toolbar=no, location=no, directories=no, status=no, menubar=no';\n                features += ', resizable=yes, scrollbars=yes, copyhistory=no, width=' + w;\n                features += ', height=' + h + ', top=' + top + ', left=' + left;\n                var win = window.open($(this).attr('href'), '_blank', features);\n                if (!win) {\n                    return true;\n                }\n            } catch (ex) {\n                VPLUtil.log(ex);\n                return true;\n            }\n            e.preventDefault();\n            $(this).parent().hide();\n            return false;\n        };\n\n        VPLUtil.acceptCertificates = function(servers, getLastAction) {\n            if (servers.length > 0) {\n                // Generate links dialog.\n                var html = VPLUtil.str('acceptcertificatesnote');\n                html += '<ol>';\n                var i;\n                for (i in servers) {\n                    if (servers.hasOwnProperty(i)) {\n                        var n = 1 + i;\n                        html += '<li><a href=\"' + servers[i] + '\" target=\"_blank\">Server ';\n                        html += n + '</a></li>';\n                    }\n                }\n                html += '</ol>';\n                var m = VPLUtil.showMessage(html, {\n                    ok: function() {\n                        var action = getLastAction();\n                        if (action) {\n                            action();\n                        }\n                    },\n                    icon: 'unlocked',\n                    title: VPLUtil.str('acceptcertificates')\n                });\n                $(m).find('a').on('click keypress', VPLUtil.clickServer);\n            } else {\n                VPLUtil.log('servers.length == 0');\n                VPLUtil.showErrorMessage(VPLUtil.str('connection_fail'));\n            }\n        };\n        VPLUtil.monitorRunning = VPLUtil.returnFalse;\n        VPLUtil.webSocketMonitor = function(coninfo, title, running, externalActions) {\n            VPLUtil.setProtocol(coninfo);\n            var ws = null;\n            var pb = null;\n            var deferred = $.Deferred();\n            var defail = function(m) {\n                deferred.reject(m);\n            };\n            var delegated = false;\n            var messageActions = {\n                'message': function(content) {\n                    var parsed = /^([^:]*):?([^]*)/.exec(content);\n                    var state = parsed[1];\n                    var detail = parsed[2];\n                    if (state == 'running') {\n                        state = running;\n                    }\n                    var text = VPLUtil.str(state);\n                    if (detail > '') {\n                        text += ': ' + detail;\n                    }\n                    if (pb !== null && !pb.isClosed()) {\n                        pb.setLabel(text);\n                    } else if (externalActions.getConsole && externalActions.getConsole().isOpen()) {\n                        externalActions.getConsole().setMessage(text);\n                    } else {\n                        VPLUtil.log('Error: no dialogo. Message not shown: ' + text);\n                    }\n                },\n                'compilation': function(content) {\n                    if (externalActions.setResult) {\n                        externalActions.setResult({\n                            'compilation': content,\n                        }, false);\n                    }\n                },\n                'retrieve': function() {\n                    pb.close();\n                    delegated = true;\n                    VPLUtil.requestAction('retrieve', '', '', externalActions.ajaxurl)\n                    .done(\n                        function(response) {\n                            deferred.resolve();\n                            if (externalActions.setResult) {\n                                externalActions.setResult(response, true);\n                            }\n                        }\n                   ).fail(defail);\n                },\n                'run': function(content) {\n                    pb.close();\n                    externalActions.run(content, coninfo, ws);\n                },\n                'close': function() {\n                    VPLUtil.log('ws close message from jail');\n                    ws.close();\n                }\n            };\n            try {\n                if (VPLUtil.supportWebSocket()) {\n                    ws = new WebSocket(coninfo.monitorURL);\n                } else {\n                    VPLUtil.log('ws not available');\n                    deferred.reject(VPLUtil.str('browserupdate'));\n                    return deferred;\n                }\n            } catch (e) {\n                VPLUtil.log('ws new say ' + e);\n                deferred.reject(e.message);\n                return deferred;\n            }\n            pb = new VPLUtil.progressBar(title, 'connecting', function() {\n                deferred.reject('Stopped by user');\n                ws.close();\n            });\n            ws.notOpen = true;\n            ws.onopen = function() {\n                ws.notOpen = false;\n                pb.setLabel(VPLUtil.str('connected'));\n                if (externalActions.open) {\n                    externalActions.open();\n                }\n            };\n            ws.onerror = function(event) {\n                VPLUtil.log('ws error ' + event);\n                pb.close();\n                if (coninfo.secure && ws.notOpen) {\n                    VPLUtil.requestAction('getjails', 'retrieve', {}, externalActions.ajaxurl)\n                    .done(function(response) {\n                        VPLUtil.acceptCertificates(response.servers, function() {\n                            return externalActions.getLastAction();\n                        });\n                    })\n                    .fail(defail);\n                } else {\n                    deferred.reject(VPLUtil.str('connection_fail'));\n                }\n                if (externalActions.close) {\n                    VPLUtil.delay('externalActions.close', externalActions.close);\n                }\n            };\n            ws.onclose = function() {\n                if (externalActions.getConsole) {\n                    externalActions.getConsole().disconnect();\n                }\n                if (!ws.notOpen) {\n                    pb.close();\n                    if (!delegated && deferred.state() != 'rejected') {\n                        deferred.resolve();\n                    }\n                }\n                if (externalActions.close) {\n                    externalActions.close();\n                }\n            };\n\n            ws.onmessage = function(event) {\n                var message = /^([^:]+):([^]*)/.exec(event.data);\n                if (message !== null) {\n                    var action = message[1];\n                    var content = message[2];\n                    if (messageActions[action]) {\n                        messageActions[action](content);\n                    }\n                } else {\n                    pb.setLabel(VPLUtil.str('error') + ': ' + event.data);\n                }\n            };\n            VPLUtil.monitorRunning = function() {\n                return ws !== null && ws.readyState != WebSocket.CLOSED;\n            };\n            return deferred;\n        };\n        VPLUtil.processResult = function(text, filenames, sh, noFormat, folding) {\n            if (typeof text == 'undefined' || text.replace(/^\\s+$/gm, '') == '') {\n                return '';\n            }\n            /**\n             * Adds escape to the text\n             * @param {string} t text to escape\n             * @returns {string} result\n             */\n            function escReg(t) {\n                return t.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/, \"\\\\$&\");\n            }\n            var regtitgra = /\\([-]?[\\d]+[.]?[\\d]*\\)\\s*$/;\n            var regtit = /^-.*/;\n            var regcas = /^\\s*>/;\n            // TODO adds error? use first anotation for icon.\n            var regError = new RegExp('\\\\[err\\\\]|error|' + escReg(VPLUtil.str('error')), 'i');\n            var regWarning = new RegExp('\\\\[warn\\\\]|warning|note|' + escReg(VPLUtil.str('warning')), 'i');\n            var regInformation = new RegExp('\\\\[info\\\\]|information', 'i');\n            var state = '';\n            var html = '';\n            var comment = '';\n            var case_ = '';\n            var lines = text.split(/\\r\\n|\\n|\\r/);\n            var regFiles = [];\n            var lastAnotation = false;\n            var lastAnotationFile = false;\n            var afterTitle = false;\n            /**\n             * Generate attribute href for the editor in sh\n             * @param {int} i Index of sh\n             * @return {strng} href\n             */\n            function getHref(i) {\n                if (typeof sh[i].getTagId === 'undefined') {\n                    return 'href=\"#\" ';\n                } else {\n                    return 'href=\"#' + sh[i].getTagId() + '\" ';\n                }\n            }\n            (function() {\n                for (var i = 0; i < filenames.length; i++) {\n                    var regf = escReg(filenames[i]);\n                    // Filename:N, filename(N), filename N, filename line N, filename on line N.\n                    // N=#|#:#|#,#.\n                    var reg = \"(^|.* |.*/)\" + regf + \"( on line | line |:|\\\\()(\\\\d+)(:|,)?(\\\\d+)?(\\\\))?\";\n                    regFiles[i] = new RegExp(reg, '');\n                }\n            })();\n            /**\n             * Generate the file links in the comments to point to the files\n             * @param {string} line Line to modify\n             * @param {string} rawline Text to include in annotation\n             * @returns {string} The line modified\n             */\n            function genFileLinks(line, rawline) {\n                var used = false;\n                for (var i = 0; i < regFiles.length; i++) {\n                    var reg = regFiles[i];\n                    var match;\n                    while ((match = reg.exec(line)) !== null) {\n                        var anot = sh[i].getAnnotations();\n                        // Annotation format {row:,column:,raw:,type:error,warning,info;text} .\n                        lastAnotationFile = i;\n                        used = true;\n                        var type;\n                        if (line.search(regError) > -1) {\n                            type = 'error';\n                        } else if (line.search(regWarning) > -1) {\n                            type = 'warning';\n                        } else if (line.search(regInformation) > -1) {\n                            type = 'info';\n                        } else {\n                            type = 'error';\n                        }\n                        lastAnotation = {\n                            'row': (match[3] - 1),\n                            'column': match[5],\n                            'type': type,\n                            'text': rawline,\n                        };\n                        anot.push(lastAnotation);\n                        var fileName = filenames[i];\n                        var href = getHref(i);\n                        var lt = VPLUtil.sanitizeText(fileName);\n                        var data = 'data-file=\"' + fileName + '\" data-line=\"' + match[3] + '\"';\n                        line = line.replace(reg, '$1<a ' + href + ' class=\"vpl_fl\" ' + data + '>' + lt + '$2$3$4$5$6</a>');\n                        sh[i].setAnnotations(anot);\n                    }\n                }\n                if (!used && lastAnotation) {\n                    if (rawline !== '') {\n                        lastAnotation.text += \"\\n\" + rawline;\n                        sh[lastAnotationFile].setAnnotations(sh[lastAnotationFile].getAnnotations());\n                    } else {\n                        lastAnotation = false;\n                    }\n                }\n                return line;\n            }\n            /**\n             * Generates HTML for title line\n             * @param {string} line The line to process\n             * @returns {string} Line in HTML format\n             */\n            function getTitle(line) {\n                lastAnotation = false;\n                line = line.substr(1);\n                var end = regtitgra.exec(line);\n                if (end !== null) {\n                    line = line.substr(0, line.length - end[0].length);\n                }\n                var html = '';\n                if (folding) {\n                    html += '<a href=\"javascript:void(0)\" onclick=\"VPLUtil.showHideDiv(this)\">[+]</a>';\n                }\n                html += '<b class=\"ui-widget-header ui-corner-all\">' + VPLUtil.sanitizeText(line) + '</b><br>';\n                html = genFileLinks(html, line);\n                return html;\n            }\n            /**\n             * Returns comment that has been saved\n             * @returns {string}\n             */\n            function getComment() {\n                lastAnotation = false;\n                var ret = comment;\n                comment = '';\n                return ret;\n            }\n            /**\n             * Adds a new comment in HTML\n             * @param {string} rawline  Comment to add\n             */\n            function addComment(rawline) {\n                var line = VPLUtil.sanitizeText(rawline);\n                comment += genFileLinks(line, rawline) + '<br>';\n            }\n            /**\n             * Adds a new case\n             * @param {*} rawline Text to add\n             */\n            function addCase(rawline) {\n                var line = VPLUtil.sanitizeText(rawline);\n                case_ += genFileLinks(line, rawline) + \"\\n\";\n            }\n            /**\n             * Returns cases saved in HTML\n             * @returns {string}\n             */\n            function getCase() {\n                lastAnotation = false;\n                var ret = case_;\n                case_ = '';\n                return '<pre><i>' + ret + '</i></pre>';\n            }\n\n            for (var i = 0; i < lines.length; i++) {\n                var line = lines[i];\n                if (noFormat) {\n                    html += genFileLinks(VPLUtil.sanitizeText(line), line) + \"\\n\";\n                    continue;\n                }\n                var match = regcas.exec(line);\n                var regcasv = regcas.test(line);\n                if ((match !== null) != regcasv) {\n                    VPLUtil.log('error');\n                }\n                if (regtit.test(line)) {\n                    switch (state) {\n                        case 'comment':\n                            html += getComment();\n                            break;\n                        case 'case':\n                            html += getCase();\n                            break;\n                    }\n                    if (afterTitle) {\n                        html += '</div>';\n                    }\n                    html += getTitle(line);\n                    html += folding ? '<div style=\"display:none\">' : '<div>';\n                    afterTitle = true;\n                    state = '';\n                } else if (regcasv) {\n                    if (state == 'comment') {\n                        html += getComment();\n                    }\n                    addCase(line.substr(match[0].length));\n                    state = 'case';\n                } else {\n                    if (state == 'case') {\n                        html += getCase();\n                    }\n                    addComment(line);\n                    state = 'comment';\n                }\n            }\n            switch (state) {\n                case 'comment':\n                    html += getComment();\n                    break;\n                case 'case':\n                    html += getCase();\n                    break;\n            }\n            if (afterTitle) {\n                html += '</div>';\n            }\n            return html;\n        };\n        (function() {\n            var scriptsLoaded = [];\n            VPLUtil.loadScript = function(scripts, end) {\n                if (scripts.length == 0) {\n                    end();\n                    return;\n                }\n                var scriptURL = scripts[0];\n                if (typeof scriptsLoaded[scriptURL] == 'undefined') {\n                    scripts.shift();\n                    scriptsLoaded[scriptURL] = 1;\n                    var script = document.createElement('script');\n                    script.type = 'text/javascript';\n                    script.src = VPLUtil.options.scriptPath + scriptURL;\n                    script.onload = function() {\n                        scriptsLoaded[scriptURL] = 2;\n                        VPLUtil.loadScript(scripts, end);\n                    };\n                    document.head.appendChild(script);\n                } else if (scriptsLoaded[scriptURL] == 2) {\n                    scripts.shift();\n                    VPLUtil.loadScript(scripts, end);\n                } else {\n                    VPLUtil.log('Error loading js ' + scriptURL + ' ' + scriptsLoaded[scriptURL]);\n                    setTimeout(function() {\n                                  VPLUtil.loadScript(scripts, end);\n                               }, 50);\n                }\n            };\n            VPLUtil.isScriptLoading = function(scriptURL) {\n                if (typeof scriptsLoaded[scriptURL] == 'undefined') {\n                    return false;\n                }\n                return scriptsLoaded[scriptURL] == 1;\n            };\n            VPLUtil.isScriptLoaded = function(scriptURL) {\n                if (typeof scriptsLoaded[scriptURL] == 'undefined') {\n                    return false;\n                }\n                return scriptsLoaded[scriptURL] == 2;\n            };\n        })();\n        VPLUtil.adjustBlockly = function(work, offx, offy) {\n            var blocks = work.getAllBlocks();\n            var miy = 20000;\n            var may = -20000;\n            var mix = 20000;\n            var max = -20000;\n            for (var i = 0; i < blocks.length; i++) {\n                var xy = blocks[i].getRelativeToSurfaceXY();\n                miy = Math.min(miy, xy.y);\n                may = Math.max(may, xy.y);\n                mix = Math.min(mix, xy.x);\n                max = Math.max(max, xy.x);\n            }\n            blocks = work.getTopBlocks();\n            for (var j = 0; j < blocks.length; j++) {\n                blocks[j].moveBy(offx - mix, offy - miy);\n            }\n            return may - miy + 100 + offy;\n        };\n        (function() {\n            var files = [];\n            var results = [];\n            var shs = [];\n            /**\n             * Constructor for submission highlighter\n             * @param {Array} files Files to show highlighted\n             * @param {Array} results Output\n             */\n            function SubmissionHighlighter(files, results) {\n                var self = this;\n                this.files = files;\n                this.results = results;\n                setTimeout(function() {\n                              self.highlight();\n                           }, 10);\n            }\n            SubmissionHighlighter.prototype.highlightBlockly = function(preid) {\n                VPLUtil.loadScript(['../editor/blockly/blockly_compressed.js',\n                    '../editor/blockly/msg/js/en.js',\n                    '../editor/blockly/blocks_compressed.js']\n                , function() {\n                    var tag = $('#' + preid);\n                    var c = tag.html();\n                    $('#' + preid + 'load').remove();\n                    tag.html('');\n                    tag.show();\n                    c = $('<div />').html(c).text().replace(/\\n/g, \"\");\n                    var xml = Blockly.Xml.textToDom(c);\n                    tag.html('').height(300).width(tag.parent().width());\n                    var options = {\n                        toolbox: '',\n                        readOnly: true,\n                        media: '../editor/blockly/media/',\n                    };\n                    var work = Blockly.inject(preid, options);\n                    Blockly.Xml.domToWorkspace(xml, work);\n                    var hg = VPLUtil.adjustBlockly(work, 10, 10);\n                    tag.height(hg);\n                    tag.width('100%');\n                    Blockly.svgResize(work);\n                    Blockly.resizeSvgContents(work);\n                    var h = tag.html();\n                    work.dispose();\n                    tag.html(h);\n                });\n            };\n            SubmissionHighlighter.prototype.highlight = function() {\n                var self = this;\n                var needAce = false;\n                var files = this.files;\n                for (let i = 0; i < files.length; i++) {\n                    let file = files[i];\n                    if (VPLUtil.isBinary(file.fileName) || VPLUtil.isBlockly(file.fileName)) {\n                        continue;\n                    } else {\n                        needAce = true;\n                        break;\n                    }\n                }\n                if (needAce && typeof ace === 'undefined') {\n                    VPLUtil.loadScript(['../editor/ace9/ace.js'],\n                        function() {\n                           self.highlight();\n                        });\n                    return;\n                }\n                var results = this.results;\n                var shFiles = [];\n                var shFileNames = [];\n                for (let i = 0; i < files.length; i++) {\n                    let file = files[i];\n                    let preid = 'code' + file.tagId;\n                    if (VPLUtil.isBlockly(file.fileName)) {\n                        self.highlightBlockly(preid);\n                        continue;\n                    }\n                    var ext = VPLUtil.fileExtension(file.fileName);\n                    var lang = VPLUtil.langType(ext);\n                    $('#' + preid).show();\n                    $('#' + preid + 'load').remove();\n                    var sh = ace.edit(preid);\n                    sh.setTheme('ace/theme/' + file.theme);\n                    sh.getSession().setMode('ace/mode/' + lang);\n                    sh.renderer.setShowGutter(file.showln);\n                    sh.setReadOnly(true);\n                    sh.setHighlightActiveLine(false);\n                    sh.setAutoScrollEditorIntoView(true);\n                    sh.setOption('maxLines', file.nl);\n                    sh.getAnnotations = function() {\n                        return this.getSession().getAnnotations();\n                    };\n                    sh.setAnnotations = function(a) {\n                        return this.getSession().setAnnotations(a);\n                    };\n                    sh.getTagId = function() {\n                        return this.vplTagId;\n                    };\n                    sh.vplTagId = file.tagId;\n                    shFiles.push(sh);\n                    shFileNames.push(file.fileName);\n                    shs[file.tagId] = sh;\n                }\n                for (var ri = 0; ri < results.length; ri++) {\n                    var tag = document.getElementById(results[ri].tagId);\n                    var text = tag.textContent || tag.innerText;\n                    tag.innerHTML = VPLUtil.processResult(text, shFileNames, shFiles,\n                                                           results[ri].noFormat, results[ri].folding);\n                }\n            };\n\n            VPLUtil.addResults = function(tagId, noFormat, folding) {\n                results.push({'tagId': tagId, 'noFormat': noFormat, 'folding': folding});\n            };\n            VPLUtil.syntaxHighlightFile = function(tagId, fileName, theme, showln, nl) {\n                files.push({\n                    'tagId': tagId,\n                    'fileName': fileName,\n                    'theme': theme,\n                    'showln': showln,\n                    'nl': nl\n                 });\n            };\n            VPLUtil.syntaxHighlight = function() {\n                new SubmissionHighlighter(files, results);\n                files = [];\n                results = [];\n            };\n            VPLUtil.flEventHandler = function(event) {\n                var tag = event.target.getAttribute('href').substring(1);\n                var line = event.target.getAttribute('data-line');\n                var sh = shs[tag];\n                sh.gotoLine(line, 0);\n                sh.scrollToLine(line, true);\n            };\n            VPLUtil.setflEventHandler = function() {\n                var links = document.getElementsByClassName(\"vpl_fl\");\n                for (var i = 0; i < links.length; i++) {\n                    links[i].onclick = VPLUtil.flEventHandler;\n                }\n            };\n            VPLUtil.showHideDiv = function(a) {\n                var text = a;\n                var div = a;\n                if (!div.nextSibling) {\n                    div = div.parentNode;\n                }\n                div = div.nextSibling;\n                while (div.nodeName != 'DIV' && div.nodeName != 'PRE') {\n                    div = div.nextSibling;\n                    if (!div) {\n                        return;\n                    }\n                }\n                if (text) {\n                    if (text.innerHTML == '[+]') {\n                        if (div.savedDisplay) {\n                            div.style.display = div.savedDisplay;\n                        } else {\n                            div.style.display = '';\n                        }\n                        text.innerHTML = '[-]';\n                    } else {\n                        div.savedDisplay = div.style.display;\n                        div.style.display = 'none';\n                        text.innerHTML = '[+]';\n                    }\n                }\n            };\n\n        })();\n        VPLUtil.options = {\n            scriptPath: ''\n        };\n        if (typeof window.VPLDebugMode != 'undefined') {\n            debugMode = window.VPLDebugMode;\n        }\n        VPLUtil.init = function(options) {\n            VPLUtil.options = {\n                scriptPath: ''\n            };\n            $.extend(VPLUtil.options, options);\n            if (typeof window.VPLDebugMode != 'undefined') {\n                debugMode = window.VPLDebugMode;\n            }\n            VPLUtil.log(VPLUtil.options);\n        };\n        // Needs global use of VPLUtil for view source.\n        window.VPLUtil = VPLUtil;\n        return VPLUtil;\n    }\n);\n"],"file":"vplutil.min.js"}