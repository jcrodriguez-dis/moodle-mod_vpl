define("mod_vpl/vplidecodefile",["exports","jquery","mod_vpl/vplutil","mod_vpl/vplui"],(function(_exports,_jquery,_vplutil,_vplui){var obj;
/**
   * Code files extension method using ACE editorfiles. Add to VPLFile object.
   *
   * @copyright 2013 Juan Carlos Rodríguez-del-Pino
   * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.codeExtension=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};_exports.codeExtension=function(){var self=this,editor=null,session=null,readOnly=self.getFileManager().readOnly,getOldContent=this.getContent;this.getContent=function(){return this.isOpen()?editor.getValue():getOldContent.call(this)};var setOldContent=this.setContent;this.setContent=function(c){setOldContent.call(this,c),this.isOpen()&&editor.setValue(c)};var oldDestroy=this.destroy;this.destroy=function(){this.isOpen()&&editor.destroy(),oldDestroy.call(this)},this.setFontSize=function(size){this.isOpen()&&editor.setFontSize(size)};var oldAdjustSize=this.adjustSize;this.adjustSize=function(){return!!oldAdjustSize.call(this)&&(editor.resize(!0),!0)},this.gotoLine=function(line){this.isOpen()&&(editor.gotoLine(line,0),editor.scrollToLine(line,!0),editor.focus(),this.updateStatus())},this.setReadOnly=function(s){readOnly=s,this.isOpen()&&editor.setReadOnly(s)},this.isReadOnly=function(){return readOnly},this.focus=function(){if(this.isOpen()){var tid=this.getTId();(0,_jquery.default)(tid).removeClass("ui-widget-content ui-tabs-panel"),editor.focus(),this.updateStatus()}},this.blur=function(){this.isOpen()&&editor.blur()},this.undo=function(){this.isOpen()&&(editor.undo(),editor.focus())},this.redo=function(){this.isOpen()&&(editor.redo(),editor.focus())},this.selectAll=function(){this.isOpen()&&(editor.selectAll(),editor.focus())},this.hasUndo=function(){return!!this.isOpen()&&session.getUndoManager().hasUndo()},this.hasRedo=function(){return!!this.isOpen()&&session.getUndoManager().hasRedo()},this.hasSelectAll=_vplutil.VPLUtil.returnTrue,this.hasFind=_vplutil.VPLUtil.returnTrue,this.hasFindReplace=_vplutil.VPLUtil.returnTrue,this.hasNext=_vplutil.VPLUtil.returnTrue,this.find=function(){this.isOpen()&&editor.execCommand("find")},this.replace=function(){this.isOpen()&&editor.execCommand("replace")},this.next=function(){this.isOpen()&&editor.execCommand("findnext")},this.getAnnotations=function(){return this.isOpen()?session.getAnnotations():[]},this.setAnnotations=function(a){return!!this.isOpen()&&session.setAnnotations(a)},this.clearAnnotations=function(){return!!this.isOpen()&&session.clearAnnotations()},this.langSelection=function(){if(this.isOpen()){var filenamepath=this.getFileName(),lang=_vplutil.VPLUtil.langType(filenamepath);session.setMode("ace/mode/"+lang),session.setTabSize(4),session.setUseSoftTabs(!_vplutil.VPLUtil.useHardTabs(filenamepath)),this.setLang(lang)}},this.getEditor=function(){return!!this.isOpen()&&editor},this.setTheme=function(theme){this.isOpen()&&editor.setTheme("ace/theme/"+theme)},this.updateStatus=function(){if(this.isOpen()){var text="",pos=editor.getCursorPosition(),fullname=this.getFileName(),name=_vplutil.VPLUtil.getFileName(fullname);(fullname.length>20||name!=fullname)&&(text=fullname+" "),text+="Ln "+(pos.row+1)+", Col "+(pos.column+1),text+=" "+_vplutil.VPLUtil.langName(name),_vplui.VPLUI.showIDEStatus(text)}},this.open=function(){if(this.showFileName(),"undefined"==typeof ace)return _vplutil.VPLUtil.loadScript(["/../thirdpartylibs/ace/ace.js","/../thirdpartylibs/ace/ext-language_tools.js"],(function(){self.open()})),!1;if(this.isOpen())return editor;var fileManager=this.getFileManager(),tid=this.getTId();(0,_jquery.default)(tid).removeClass("ui-widget-content ui-tabs-panel"),ace.require("ace/ext/language_tools"),editor=ace.edit("vpl_file"+this.getId()),session=editor.getSession(),editor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0}),editor.setValue(this.getContent()),editor.setFontSize(fileManager.getFontSize()),editor.setTheme("ace/theme/"+fileManager.getTheme()),editor.$blockScrolling=1/0,editor.gotoLine(1,0),editor.setReadOnly(readOnly),session.setUndoManager(new ace.UndoManager),this.setOpen(!0),this.langSelection(),editor.execCommand("replace");var addEventDrop=function(){var tag=(0,_jquery.default)(tid+" div.ace_search");tag.length?(tag.on("drop",fileManager.dropHandler),(0,_jquery.default)(".ace_searchbtn_close").trigger("click")):setTimeout(addEventDrop,50)};editor.on("change",(function(){self.change()})),session.selection.on("changeCursor",(function(){self.updateStatus()})),setTimeout(addEventDrop,5);var prevOnPaste=editor.onPaste;return editor.onPaste=function(s){fileManager.restrictedEdit?editor.insert(fileManager.getClipboard()):prevOnPaste.call(editor,s)},editor.on("copy",(function(t){fileManager.setClipboard(t.text)})),(0,_jquery.default)(tid).on("paste","*",fileManager.restrictedPaste),(0,_jquery.default)(tid+" div.ace_content").on("drop",fileManager.dropHandler),(0,_jquery.default)(tid+" div.ace_content").on("dragover",fileManager.dragoverHandler),(0,_jquery.default)(tid).find("div.ace_scroller").css("position","static"),this.adjustSize(),(0,_jquery.default)(tid).find("div.ace_scroller").css("position","absolute"),this.updateStatus(),editor},this.close=function(){this.setOpen(!1),null!==editor&&(this.setContent(editor.getValue()),editor.destroy(),editor=null,session=null)}}}));

//# sourceMappingURL=vplidecodefile.min.js.map